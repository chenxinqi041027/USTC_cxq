# 五·匹配理论

### 匹配：

- $G$的一个边子集$M$，满足$M$内任意两条边在$G$中都不相邻
- 称$M$为$G$的一个匹配
- $M$中相邻的点称为在$M$中相配
- $M$中边的端点称为被$M$许配
    - 完备匹配：$G$中所有端点都被$M$许配
- 最大匹配：边数最多的匹配，匹配数$\alpha(G)=|M|$

- 交错轨道（圈）：$G$中的轨道（圈）$P$的边在$M$与$E(G)-M$中交替出现
- 可增广轨道：$P=v_0e_1v_1e_2\cdots e_{2k+1}v_{2k+1}$，其中$e_1,e_3,\cdots,e_{2k+1}\not\in M$，$e_2,\cdots,e_{2k}\in M$，且$v_0$和$v_{2k+1}$没有被$M$许配
    - 交换$P$中所有边所属的边集，可使$|M|$增加$1$
- 最大匹配当且仅当$G$中没有关于$M$的可增广轨道

### 二分图匹配：

- $Hall$定理：设二分图点集划分为$X$和$Y$，则$G$中存在将$X$中顶点都许配的匹配，当且仅当任给$S\subseteq X$都有$|N(S)|\geq|S|$（$N(S)$为邻顶集合）
- $k$次正则二分图$G$有完备匹配
    - $EN(S)$表示与$S$中某点相邻的边集
    - 则$k\times|S|=|EN(S)|\leq|EN(N(S))|=k\times|N(S)|$
- 覆盖：点子集$C$满足$G$中任意一条边均与$C$相连
    - 极小覆盖，覆盖数$\beta(G)$
- 恒有$|C|\geq|M|$，且$|C|=|M|$时$C$是最小覆盖，$M$是最大匹配
    - $|M|\leq|M^*|\leq|C^*|\leq|C|$

- $König-Egerváry$：二分图中$\alpha(G)=\beta(G)$

### 任意图的完备匹配：

- 奇/偶片：连通片$G'$点数$\nu(G')$为奇/偶数
    - $o(G)$表示$G$中奇片个数
- $Tutte$定理：有完备匹配当且仅当任给$S\subseteq V(G)$，都有$o(G-S)\leq|S|$
- $Petersen$定理：无桥的三次正则图有完备匹配

### 最大匹配算法：

- 交错树算法：
    - 设$u$为$G$中没有被$M$许配的顶点，若包含$u$的子图$T$为树且$\forall v\in V(T)$，$T$中从$u$到$v$的轨道均为交错轨道，则称$T$是$G$中关于$M$的$u-$交错树
    - 若除$u$外，$T$中所有顶点均被$M$许配，则称$T$为被$M$许配的$u-$交错树，否则$T$中从$u$到$v$的轨道为可增广轨道

### 最佳匹配算法：

- 边权二分图$G=(X,\Delta,Y)$
- 可行顶标：$l(x)+l(y)\geq w(xy)$
    - 对于任意给定带有边权的二分图，都有可行顶标，如$l(x)=\max_{y\in Y}w(xy)$，$l(y)=0$
- $G$关于$l$的相等子图$G_l$：
    1. $V(G_l)=V(G)$
    2. $E(G_l)=\{x_iy_j|l(x_i)+l(y_j)=w(x_iy_j)\}$
- 若相等子图$G_l$由完备匹配，设为$M$，则$M$是$G$的最佳匹配
- $Kuhn-Munkreas$算法：
    1. 选取$G$的一个可行顶标，构造相等子图$G_l$
    2. 用匈牙利算法求$G_l$的最大匹配，设为$M$，若$M$不是$G$的最佳匹配
    3. 在$X$中找到未被$M$许配的顶点$u$， 令$\displaystyle\begin{cases}Z=\{v|v\in V(G_l),且u,v之间存在交错轨道\}\\S=X\cap Z\\T=Y\cap Z\end{cases}$，计算$\alpha_l=\displaystyle\min_{x_i\in S,y_j\not\in T}\{l(x_i)+l(y_j)-w(x_iy_j)\}$，修改可行顶标$\hat{l}=\displaystyle\begin{cases}l(v)-\alpha_l,&v\in S\\l(v)+\alpha_l,&v\in T\\l(v),&Otherwise\end{cases}$
    4. 