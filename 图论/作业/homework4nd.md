## 二.8

  - ### 必要性：

    - 对于树$T$，设其度数序列为$d_1,d_2,\cdots,d_\nu$，不妨令其满足$d_1\geq d_2\geq\cdots\geq d_\nu$
    - 则必有$\displaystyle\sum_{i=1}^\nu d_i=\sum_{i=1}^\nu deg(i)=2\varepsilon=2(\nu-1)$

  - ### 充分性：

    - 对于图$G$，由$\displaystyle\sum_{i=1}^\nu d_i=2\varepsilon=2(\nu-1)$知$\varepsilon=\nu-1$

    - 若图$G$为单连通图，由连通图$\varepsilon\geq\nu-1$性质知图$G$为树

    - 若图$G$为多连通图，形如下方所示的多连通带圈图也可满足$\displaystyle\sum_{i=1}^\nu d_i=2(\nu-1)$，故充分性不成立

    - ```mermaid
        graph LR
        A((1))---B((2))
        C((3))---D((4))
        D((4))---E((5))
        E((5))---C((3))
        ```

## 二.13

  - $\tau(K_\nu-e)=\tau(K_\nu)-\tau(K_\nu\cdot e)$

  - 不妨设$e=uv$，记图$G=K_\nu\cdot e$，$V(G)=V(K_\nu)/\{v\}$，$E(G)=E(K_\nu)/\{vw|v,w\in V(K_\nu)\}\cup\{uw|w\in V(G)且w\neq u\}$

  - 即在大小为$\nu-1$的完全图上加上$\nu-2$条从同$u$点发出的重边

  - 对于图$K_{\nu-1}$的任意一颗生成树$T$，记$n=|\{uw|uw\in E(T)\}|$

  - 则$\tau_n(K_{\nu-1})=C_{\nu-3}^{n-1}(\nu-2)^{\nu-n-2}$

  - 而图$E(G)$中的任一对重边不可能同时出现在生成树中

  - $$
    \begin{align}
    故\tau(G)&=\sum_{n=1}^{\nu-2}2^nC_{\nu-3}^{n-1}(\nu-2)^{\nu-n-2}\\
    &=2(\nu-2)^{\nu-3}\sum_{n=1}^{\nu-2}C_{\nu-3}^{n-1}\left(\frac{2}{\nu-2}\right)^{n-1}\\
    &=2(\nu-2)^{\nu-3}\left(\frac{2}{\nu-2}+1\right)^{\nu-3}\\
    &=2\nu^{\nu-3}
    \end{align}
    $$

  - 故$\tau(K_\nu-e)=\tau(K_\nu)-\tau(K_\nu\cdot e)=\nu^{\nu-2}-2\nu^{\nu-3}=(\nu-2)\nu^{\nu-3}$

## 二.16

1. ### 破圈法算法：

    1. 找到图中的任一圈
    2. 删除圈上边权最大的边
    3. 重复上述操作直至图中无圈，剩余的图即为原图的最小生成树

2. ### 破圈法正确性证明：

    - 假设图$G$的最小生成树为$T_0$
    - 若某一圈$u_me_1u_1\cdots e_{k-1}u_{k-1}e_kv_me_{m}u_m$上唯一一条边权最大的边为$e_m=u_mv_m$保留在最小生成树$T_0$上
    - 则在$T_0$上删除$e_m$可得到两个连通片，且圈上一定存在另一条边$e_n=u_nv_n$满足$u_n$和$v_n$各自位于不同的连通片中
    - 否则将有$u_m,u_1,u_2,\cdots,u_{k-1},v_m$均位于同一连通片中，这显然不成立
    - 若$\omega(e_n)<\omega(e_m)$，则在$T_0$上删除$e_m$并连接$e_n$仍可保证连通且为树，而总边权更小，这与$T$为最小生成树矛盾
    - 若$\omega(e_n)\geq\omega(e_m)$，这与$e_m$为圈上唯一一条最大边权的边矛盾
    - 同时上述过程也可证明若圈上出现多个最大边权，删除其中任意一条均可得到最小生成树
    - 综上，破圈法每轮删除的最大边权边的权值一定在答案中计算，即可保证最终得到的是最小生成树。

3. ### 破圈法时间复杂度分析：

    - 若采用$dfs$寻找图中的圈，时间复杂度等同于遍历整幅图，即$O(\nu+\varepsilon)$
    - 若采用$Tarjan$寻找图中的边双连通分量，每次删除连通分量内的最大边，时间复杂度同为$O(\nu+\varepsilon)$
    - 删除操作一共进行$\varepsilon-\nu+1$轮
    - 总时间复杂度为$O(\varepsilon^2)$

## 二.17

- ### 必要性：

    - 对于一颗有根树，显然除根节点入度为$0$外，其他点入度均为$1$

- ### 充分性：

    - 不妨设树$T$中唯一一个入度为$0$的点为$u_0$
    - 由于$\nu-1\displaystyle\sum_{u\in V(T)} deg^+(u)=\sum_{u\in V(T)且u\neq u_0}deg^+(u)\geq\sum_{u\in V(T)且u\neq u_0}1=\nu-1$
    - 故除$u_0$外所有点入度均为$1$
    - 对于树上任意一点$v(v\neq u_0)$，记$u_0$到$v$的轨迹为$u_0e_1u_1\cdots e_kv$
    - 由于$u_0$入度为$0$，则$e_1$必为$u_0$指向$u_1$
    - 由于$u_1$入度为$1$，对应的边仅可能为$e_1$，则$e_2$必为$u_1$指向$u_2$
    - 以此类推，轨迹上所有的边均由靠近$u_0$的点指向远离$u_0$的点
    - 若以$u_0$为根，认为有向边均由父节点指向子节点，则可得到有根树

- $Q.E.D.$